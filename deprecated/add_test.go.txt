package cli_test

import (
	"testing"

	"github.com/mortenskoett/dotf-go/pkg/cli"
	"github.com/mortenskoett/dotf-go/pkg/config"
	"github.com/mortenskoett/dotf-go/pkg/test"
)

func Test_addcommand_copies_file_and_creates_symlink(t *testing.T) {
	env := test.NewTestEnvironment()
	dfilesdir := env.DotfilesDir
	userspacedir := env.UserspaceDir
	userspacedir.AddTempFile()

	cmd := cli.NewAddCommand("cli-test", "add-test")

	conf := config.NewConfiguration()
	conf.DotfilesDir = dfilesdir.Path
	conf.UserspaceDir = userspacedir.Path

	args := cli.NewCliArguments()
	args.PosArgs = []string{}

	err := cmd.Run(args, &conf)
	if err != nil {
		test.Fail(err, "Shouldn't fail here", t)
	}
}
